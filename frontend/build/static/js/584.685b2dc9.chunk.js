"use strict";(self.webpackChunkethglobalistanbul=self.webpackChunkethglobalistanbul||[]).push([[584],{72584:(e,t,n)=>{n.d(t,{v:()=>R});var a=n(4942),r=n(13453),i=n(65957),o=n(688),c=n(58489),s=n(30456),l=n(62895),h=n.n(l);const d="eip155",p="solana",m="other",u=(e,t)=>{if(e===m)return null;const n=t?"number"===typeof t?t:parseInt(t,16):(e=>{if(e===d)return 1;if(e===p)return 1;throw new Error("Chain namespace ".concat(e," is not supported"))})(e);return e===d?(e=>1===e?{chainNamespace:d,chainId:"0x1",rpcTarget:"https://rpc.ankr.com/eth",displayName:"Ethereum Mainnet",blockExplorer:"https://etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:3===e?{chainNamespace:d,chainId:"0x3",rpcTarget:"https://rpc.ankr.com/eth_ropsten",displayName:"Ropsten Testnet",blockExplorer:"https://ropsten.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:4===e?{chainNamespace:d,chainId:"0x4",rpcTarget:"https://rpc.ankr.com/eth_rinkeby",displayName:"Rinkeby Testnet",blockExplorer:"https://rinkeby.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:5===e?{chainNamespace:d,chainId:"0x5",rpcTarget:"https://rpc.ankr.com/eth_goerli",displayName:"Goerli Testnet",blockExplorer:"https://goerli.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:137===e?{chainNamespace:d,chainId:"0x89",rpcTarget:"https://rpc.ankr.com/polygon",displayName:"Polygon Mainnet",blockExplorer:"https://polygonscan.com",ticker:"MATIC",tickerName:"Polygon"}:80001===e?{chainNamespace:d,chainId:"0x13881",rpcTarget:"https://rpc.ankr.com/polygon_mumbai",displayName:"Polygon Mumbai Testnet",blockExplorer:"https://mumbai.polygonscan.com/",ticker:"MATIC",tickerName:"Polygon",decimals:18}:56===e?{chainNamespace:d,chainId:"0x38",rpcTarget:"https://rpc.ankr.com/bsc",displayName:"Binance SmartChain Mainnet",blockExplorer:"https://bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:97===e?{chainNamespace:d,chainId:"0x61",rpcTarget:"https://rpc.ankr.com/bsc_testnet_chapel",displayName:"Binance SmartChain Testnet",blockExplorer:"https://testnet.bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:25===e?{chainNamespace:d,chainId:"0x19",rpcTarget:"https://rpc.cronos.org",displayName:"Cronos Mainnet",blockExplorer:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos"}:338===e?{chainNamespace:d,chainId:"0x152",rpcTarget:"https://rpc-t3.cronos.org/",displayName:"Cronos Testnet",blockExplorer:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos",decimals:18}:8217===e?{chainNamespace:d,chainId:"0x2019",rpcTarget:"https://public-node-api.klaytnapi.com/v1/cypress",displayName:"Klaytn Mainnet",blockExplorer:"https://scope.klaytn.com",ticker:"KLAY",tickerName:"Klaytn",decimals:18}:null)(n):e===p?(e=>1===e?{chainNamespace:p,chainId:"0x1",rpcTarget:"https://rpc.ankr.com/solana",displayName:"Solana Mainnet",blockExplorer:"https://explorer.solana.com",ticker:"SOL",tickerName:"Solana",decimals:9}:2===e?{chainNamespace:p,chainId:"0x2",rpcTarget:"https://api.testnet.solana.com",displayName:"Solana Testnet",blockExplorer:"https://explorer.solana.com?cluster=testnet",ticker:"SOL",tickerName:"Solana",decimals:9}:3===e?{chainNamespace:p,chainId:"0x3",rpcTarget:"https://api.devnet.solana.com",displayName:"Solana Devnet",blockExplorer:"https://explorer.solana.com?cluster=devnet",ticker:"SOL",tickerName:"Solana",decimals:9}:null)(n):null};class g extends o.s{constructor(e,t){super(t),(0,a.Z)(this,"code",void 0),(0,a.Z)(this,"message",void 0),this.code=e,this.message=t||"",Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class f extends g{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new f(e,"".concat(f.messages[e],", ").concat(t))}static notFound(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5001,e)}static notInstalled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5002,e)}static notReady(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5003,e)}static windowBlocked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5004,e)}static windowClosed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5005,e)}static incompatibleChainNameSpace(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5006,e)}static duplicateAdapterError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5007,e)}static invalidProviderConfigError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5008,e)}static providerNotReadyError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5009,e)}static rpcConnectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5010,e)}static invalidParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5011,e)}static invalidNetwork(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.fromCode(5013,e)}}(0,a.Z)(f,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class N extends g{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new N(e,"".concat(N.messages[e],". ").concat(t))}static connectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return N.fromCode(5111,e)}static disconnectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return N.fromCode(5112,e)}static notConnectedError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return N.fromCode(5113,e)}static popupClosed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return N.fromCode(5114,e)}static mfaEnabled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return N.fromCode(5115,e)}}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(0,a.Z)(N,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa"});const C={OPENLOGIN:"openlogin",WALLET_CONNECT_V1:"wallet-connect-v1",WALLET_CONNECT_V2:"wallet-connect-v2"},y=E({TORUS_SOLANA:"torus-solana",PHANTOM:"phantom",SOLFLARE:"solflare",SLOPE:"slope"},C),b=E({TORUS_EVM:"torus-evm",METAMASK:"metamask",COINBASE:"coinbase"},C),k=E(E({},b),y);y.TORUS_SOLANA,y.PHANTOM,y.SOLFLARE,y.SLOPE,b.TORUS_EVM,b.METAMASK,b.COINBASE;function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const T={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"},A=O(O({},T),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated"});class I extends i.Ue{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,a.Z)(this,"adapterData",{}),(0,a.Z)(this,"sessionTime",86400),(0,a.Z)(this,"clientId",void 0),(0,a.Z)(this,"web3AuthNetwork",r.dr.MAINNET),(0,a.Z)(this,"rehydrated",!1),(0,a.Z)(this,"chainConfig",null),this.setAdapterSettings(e)}get chainConfigProxy(){return this.chainConfig?O({},this.chainConfig):null}setAdapterSettings(e){if(this.status===T.READY)return;null!==e&&void 0!==e&&e.sessionTime&&(this.sessionTime=e.sessionTime),null!==e&&void 0!==e&&e.clientId&&(this.clientId=e.clientId),null!==e&&void 0!==e&&e.web3AuthNetwork&&(this.web3AuthNetwork=e.web3AuthNetwork);const t=e.chainConfig;if(t){if(!t.chainNamespace)throw f.notReady("ChainNamespace is required while setting chainConfig");this.currentChainNamespace=t.chainNamespace;const e=O(O({},u(t.chainNamespace,t.chainId)||{}),t);this.chainConfig=e}}checkConnectionRequirements(){if(this.name!==k.WALLET_CONNECT_V1||this.status!==T.CONNECTING){if(this.status===T.CONNECTING)throw f.notReady("Already connecting");if(this.status===T.CONNECTED)throw N.connectionError("Already connected");if(this.status!==T.READY)throw N.connectionError("Wallet adapter is not ready yet, Please wait for init function to resolve before calling connect/connectTo function")}}checkInitializationRequirements(){if(!this.clientId)throw f.invalidParams("Please initialize Web3Auth with a valid clientId in constructor");if(!this.chainConfig)throw f.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.rpcTarget&&this.chainConfig.chainNamespace!==m)throw f.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.chainId&&this.chainConfig.chainNamespace!==m)throw f.invalidParams("chainID is required in chainConfig");if(this.status!==T.NOT_READY){if(this.status===T.CONNECTED)throw f.notReady("Already connected");if(this.status===T.READY)throw f.notReady("Adapter is already initialized")}}checkDisconnectionRequirements(){if(this.status!==T.CONNECTED)throw N.disconnectionError("Not connected with wallet")}updateAdapterData(e){this.adapterData=e,this.emit(A.ADAPTER_DATA_UPDATED,{adapterName:this.name,data:e})}}const S="https://authjs.web3auth.io";var P=h().getLogger("web3auth-logger");function D(e){let t,n=!1,a=0;try{t=window[e],n=!0,a=t.length;const r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(r){const e=r;return!(!e||22!==e.code&&1014!==e.code&&"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||!n||0===a)}}var _=n(66315),x=n.n(_);class R extends I{async init(e){this.chainConfig||(this.chainConfig=u(p,1))}async authenticateUser(){if(!this.provider||this.status!==T.CONNECTED)throw N.notConnectedError();const{chainNamespace:e,chainId:t}=this.chainConfig,n=await this.provider.request({method:"getAccounts"});if(n&&n.length>0){const i=(a=n[0],r=this.name,D("localStorage")?localStorage.getItem("".concat(a.toLowerCase(),"_").concat(r)):null);if(i){if(!(e=>{const t=(0,s.Z)(e);return!t.exp||t.exp<Math.floor(Date.now()/1e3)})(i))return{idToken:i}}const o={domain:window.location.origin,uri:window.location.href,address:n[0],chainId:parseInt(t,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:(new Date).toISOString()},l=await(async(e,t)=>{const n={payload:e,header:{t:"solana"===t?"sip99":"eip191"},network:"solana"===t?"solana":"ethereum"},a=await(0,c.v_)("".concat(S,"/siww/get"),n);if(!a.success)throw new Error("Failed to authenticate user, Please reach out to Web3Auth Support team");return a.challenge})(o,e),h=(new TextEncoder).encode(l),d=await this.provider.request({method:"signMessage",params:{message:h,display:"utf8"}}),p=await(async(e,t,n,a,r,i,o)=>{const s={signature:{s:t,t:"solana"===e?"sip99":"eip191"},message:n,issuer:a,audience:window.location.hostname,timeout:r},l=await(0,c.v_)("".concat(S,"/siww/verify"),s,{headers:{client_id:i,wallet_provider:a,web3auth_network:o}});if(!l.success)throw P.error("Failed to authenticate user, ,message verification failed",l.error),new Error("Failed to authenticate user, ,message verification failed");return l.token})(e,x().encode(d),l,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return((e,t,n)=>{D("localStorage")&&localStorage.setItem("".concat(e.toLowerCase(),"_").concat(t),n)})(n[0],this.name,p),{idToken:p}}var a,r;throw N.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnectSession(){super.checkDisconnectionRequirements();const e=await this.provider.request({method:"getAccounts"});var t,n;e&&e.length>0&&(t=e[0],n=this.name,D("localStorage")&&localStorage.removeItem("".concat(t.toLowerCase(),"_").concat(n)))}async disconnect(){this.rehydrated=!1,this.emit(A.DISCONNECTED)}}}}]);
//# sourceMappingURL=584.685b2dc9.chunk.js.map